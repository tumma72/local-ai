{
  "permissions": {
    "allow": [
      "Bash(xargs ls:*)",
      "Bash(python3:*)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:blaizzy.github.io)",
      "Bash(ls:*)",
      "Bash(source:*)",
      "WebFetch(domain:pypi.org)",
      "Bash(/Users/atomasini/Development/local-llms/.venv/bin/python:*)",
      "mcp__zen__apilookup",
      "Bash(xargs dirname:*)",
      "Bash(curl:*)",
      "Bash(gh search:*)",
      "Bash(for i in 1 2 3)",
      "Bash(PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1 uv pip install:*)",
      "Bash(mlx-omni-server:*)",
      "Bash(__NEW_LINE__ echo \"\")",
      "Bash(lsof:*)",
      "Bash(kill:*)",
      "Bash(goose --version:*)",
      "Bash(goose --help:*)",
      "Bash(goose run:*)",
      "Bash(goose bench:*)",
      "Bash(goose configure:*)",
      "Bash(goose info:*)",
      "Bash(GOOSE_PROVIDER=openai OPENAI_HOST=http://127.0.0.1:8080/ OPENAI_API_KEY=not-needed goose run:*)",
      "Bash(local-ai status:*)",
      "Bash(local-ai:*)",
      "Bash(GOOSE_PROVIDER=openai OPENAI_HOST=http://127.0.0.1:8080/ OPENAI_API_KEY=not-needed GOOSE_MODEL=mlx-community/Orchestrator-8B-8bit goose run:*)",
      "Bash(GOOSE_PROVIDER=openai OPENAI_HOST=http://127.0.0.1:8080/ OPENAI_API_KEY=not-needed GOOSE_MODEL=mlx-community/Qwen3-Coder-30B-A3B-Instruct-8bit GOOSE_LEAD_MODEL=mlx-community/Qwen3-Coder-30B-A3B-Instruct-8bit GOOSE_ENABLE_ROUTER=false goose run:*)",
      "Bash(timeout 120 uv run python:*)",
      "Bash(GOOSE_PROVIDER=openai OPENAI_HOST=http://127.0.0.1:8080/ OPENAI_API_KEY=not-needed GOOSE_MODEL=mlx-community/Qwen3-Coder-30B-A3B-Instruct-8bit GOOSE_LEAD_MODEL=mlx-community/Qwen3-Coder-30B-A3B-Instruct-8bit GOOSE_ENABLE_ROUTER=false RUST_LOG=debug goose run:*)",
      "Bash(pip show:*)",
      "Bash(xargs:*)",
      "Bash(tee:*)",
      "Bash(gh repo fork:*)",
      "Bash(gh pr create:*)",
      "Bash(goose recipe:*)",
      "WebFetch(domain:block.github.io)",
      "Bash(GOOSE_PROVIDER=openai:*)",
      "Bash(OPENAI_HOST=http://127.0.0.1:8080/:*)",
      "Bash(OPENAI_API_KEY=not-needed:*)",
      "Bash(GOOSE_MODEL=mlx-community/Qwen3-Coder-30B-A3B-Instruct-8bit:*)",
      "Bash(timeout 180 goose run:*)",
      "Bash(grep:*)",
      "Bash(OPENAI_HOST=http://127.0.0.1:10240/:*)",
      "Bash(GOOSE_MODEL=mlx-community/gemma-3-27b-it-4bit-DWQ )",
      "Bash(GOOSE_LEAD_MODEL=mlx-community/gemma-3-27b-it-4bit-DWQ:*)",
      "Bash(GOOSE_ENABLE_ROUTER=false :*)",
      "Bash(black:*)",
      "Bash(isort:*)",
      "Bash(pkill:*)",
      "Bash(gh pr view:*)",
      "Bash(gh pr edit 94 --repo madroidmaq/mlx-omni-server --body \"$(cat <<''EOF''\n## Summary\n\n- Fixes #93 - 500 error when using tool calling with Qwen3 MoE models\n\nThis PR addresses two related issues in the tool calling flow:\n\n### Issue 1: ToolCall Type Mismatch (openai_adapter.py)\n\n**Problem:** The tool parsers (e.g., `Qwen3MoeToolParser`) return `core_types.ToolCall` with `arguments` as a `Dict`, but `ChatMessage.tool_calls` expects `schema.ToolCall` with `function.arguments` as a JSON string.\n\nThis type mismatch caused a Pydantic validation error and 500 Internal Server Error when using function calling.\n\n**Solution:** Added a `_convert_tool_calls()` helper function that uses the existing `ToolCall.from_llama_output()` method to convert the internal format to OpenAI-compatible format.\n\n### Issue 2: JSON Arguments for Jinja Template (chat_template.py)\n\n**Problem:** In multi-turn conversations, the Qwen3 chat template expects `tool_call.arguments` to be a dict for `|items` Jinja iteration, but the OpenAI API format sends arguments as JSON strings. This caused \"Can only get item pairs from a mapping\" errors.\n\n**Solution:** Convert Pydantic ToolCall models to dicts using `model_dump()` and parse JSON string arguments into dicts before template rendering.\n\n## Testing\n\nTested with:\n- Qwen3-Coder-30B-A3B-Instruct model\n- Multi-turn agentic workflows using Goose CLI\n- Tool calls including shell commands and file operations\n\nBoth single-shot tool calls and multi-turn conversations now work correctly.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\nEOF\n)\")",
      "Bash(timeout 300 uv run:*)",
      "Bash(sysctl:*)",
      "Bash(system_profiler:*)",
      "Bash(source .venv/bin/activate)",
      "Bash(ruff check:*)",
      "Bash(wc:*)",
      "Bash(sort:*)"
    ]
  }
}
